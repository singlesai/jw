{"version":3,"file":"js/523.3a8501fd.js","mappings":"8LAQSA,MAAA,iB,+KAPTC,EAAAA,EAAAA,IAWM,aAVFC,EAAAA,EAAAA,IAAsCC,EAAAA,CAAzBC,MAAM,QACnBF,EAAAA,EAAAA,IAQWG,EAAAA,CARAC,SAAQC,EAAAA,UAAQ,C,kBAC3B,IAGiB,EAHjBL,EAAAA,EAAAA,IAGiBM,EAAAA,CAHDC,MAAA,IAAK,C,kBACjB,IAA0H,EAA1HP,EAAAA,EAAAA,IAA0HQ,EAAAA,C,WAAtGC,EAAAA,S,qCAAAA,EAAAA,SAAQ,GAAEC,KAAK,MAAMC,MAAM,MAAMC,YAAY,MAAOC,MAAO,CAAC,CAADC,UAAAA,EAAAC,QAAAA,Y,wBAC/Ef,EAAAA,EAAAA,IAAsIQ,EAAAA,C,WAAlHC,EAAAA,S,qCAAAA,EAAAA,SAAQ,GAAEO,KAAK,WAAWN,KAAK,KAAKC,MAAM,KAAKC,YAAY,KAAMC,MAAO,CAAC,CAADC,UAAAA,EAAAC,QAAAA,W,iCAEhGE,EAAAA,EAAAA,GAEM,MAFNC,EAEM,EADFlB,EAAAA,EAAAA,IAA8EmB,EAAAA,CAAlEC,MAAA,GAAMC,MAAA,GAAML,KAAK,UAAU,cAAY,U,mBAAS,IAAK,UAAL,W,4EAWpE,GACEN,KAAM,SACNY,OACE,MAAO,CACLC,SAAU,GACVC,SAAU,GAEd,EACAC,QAAS,CACPC,iBACE,IACE,IAAIC,EAAOC,EAAAA,EAAAA,QACPC,QAAiBF,EAAKG,aAAaC,KAAKR,SAAUQ,KAAKP,UAC3DK,EAASG,OAAQ,EACjBH,EAASI,QAAS,EAClB,IAAIC,EAAM,GACVA,EAAIC,KAAKN,EAASO,YAClB,MAAMF,EAAIG,OAAO,EACjB,CACI,IAAIC,QAAiBV,EAAAA,EAAAA,MAAc,eAAeW,KAAKL,EAAK,CAAC,YAAY,aAAc,aAAc,gBAAiB,kBAGtH,IAAK,IAAIM,KAFTC,QAAQC,IAAI,UAAWJ,GACvBJ,EAAM,GACUI,EAAU,CACtB,IAAIK,EAAUL,EAASE,GACnBG,EAAQC,cAAc,IACtBf,EAASI,QAAS,GAElBU,EAAQE,cAAc,IACtBhB,EAASG,OAAQ,GAEjBW,EAAQG,WACRZ,EAAIC,KAAKQ,EAAQG,UAAU,GAEnC,CACJ,CAEA,IADAC,EAAAA,EAAAA,IAAgB,CAACC,KAAMC,KAAKC,UAAUrB,KACnCA,EAASI,SAAWJ,EAASG,MAE5B,YADJD,KAAKoB,QAAQhB,KAAK,CAACzB,KAAM,WAGzB,GAAGmB,EAASG,QAAUH,EAASI,OAE3B,YADJF,KAAKoB,QAAQhB,KAAK,CAACzB,KAAM,WAGzBqB,KAAKoB,QAAQhB,KAAK,CAACzB,KAAM,UAG3B,CAFE,MAAO0C,GACPC,EAAAA,EAAAA,KAAWD,EAAGrC,SAAWqC,EAC3B,CACF,I,UC/DJ,MAAME,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://tico-yt-mobile/./src/components/page/Login.vue","webpack://tico-yt-mobile/./src/components/page/Login.vue?9588"],"sourcesContent":["<template>\r\n<div>\r\n    <van-nav-bar title=\"登录\"></van-nav-bar>\r\n    <van-form @submit=\"onSubmit\">\r\n    <van-cell-group inset>\r\n        <van-field v-model=\"username\" name=\"用户名\" label=\"用户名\" placeholder=\"用户名\" :rules=\"[{ required: true, message: '请填写用户名' }]\" />\r\n        <van-field v-model=\"password\" type=\"password\" name=\"密码\" label=\"密码\" placeholder=\"密码\" :rules=\"[{ required: true, message: '请填写密码' }]\" />\r\n    </van-cell-group>\r\n    <div style=\"margin: 16px;\">\r\n        <van-button round block type=\"primary\" native-type=\"submit\">  提交 </van-button>\r\n    </div>\r\n    </van-form>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport odooApi from '@/srv'\r\nimport { setLocalStorage } from '@/utils/local-storage'\r\nimport { Toast } from 'vant'\r\n\r\nexport default {\r\n  name: 'pLogin',\r\n  data () {\r\n    return {\r\n      username: '',\r\n      password: ''\r\n    }\r\n  },\r\n  methods: {\r\n    async onSubmit () {\r\n      try {\r\n        var auth = odooApi.session\r\n        var loginRst = await auth.authenticate(this.username, this.password)\r\n        loginRst.isSup = false\r\n        loginRst.isCust = false\r\n        var ids = []\r\n        ids.push(loginRst.partner_id)\r\n        while(ids.length>0)\r\n        {\r\n            var partners = await odooApi.model('res.partner').read(ids, ['parent_id','company_id', 'is_company', 'customer_rank', 'supplier_rank'])\r\n            console.log('partner', partners)\r\n            ids = []\r\n            for (var idx in partners) {\r\n                var partner = partners[idx]\r\n                if (partner.customer_rank>0) {\r\n                    loginRst.isCust = true\r\n                }\r\n                if (partner.supplier_rank>0) {\r\n                    loginRst.isSup = true\r\n                }\r\n                if (partner.parent_id) {\r\n                    ids.push(partner.parent_id[0])\r\n                }\r\n            }\r\n        }\r\n        setLocalStorage({user: JSON.stringify(loginRst)})\r\n        if(loginRst.isCust && !loginRst.isSup) {\r\n        this.$router.push({name: 'PurOrd'})\r\n            return\r\n        }\r\n        if(loginRst.isSup && !loginRst.isCust) {\r\n        this.$router.push({name: 'PurOrd'})\r\n            return\r\n        }\r\n        this.$router.push({name: 'PurOrd'})\r\n      } catch (ex) {\r\n        Toast.fail(ex.message || ex)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>","import { render } from \"./Login.vue?vue&type=template&id=34b2c870\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\code\\\\jw\\\\tico-yt-mobile\\\\node_modules\\\\_vue-loader@17.0.1@vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["style","_createElementBlock","_createVNode","_component_van_nav_bar","title","_component_van_form","onSubmit","$options","_component_van_cell_group","inset","_component_van_field","$data","name","label","placeholder","rules","required","message","type","_createElementVNode","_hoisted_1","_component_van_button","round","block","data","username","password","methods","async","auth","odooApi","loginRst","authenticate","this","isSup","isCust","ids","push","partner_id","length","partners","read","idx","console","log","partner","customer_rank","supplier_rank","parent_id","setLocalStorage","user","JSON","stringify","$router","ex","Toast","__exports__","render"],"sourceRoot":""}