{"version":3,"file":"js/511.035b3f93.js","mappings":"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","sources":["webpack://tico-yt-mobile/./src/components/page/PurOrd.vue","webpack://tico-yt-mobile/./src/components/page/PurOrd.vue?393a"],"sourcesContent":["<template>\r\n    <div>\r\n        <van-nav-bar title=\"退货计划\" @click-right=\"onClickRight\">\r\n          <template #right>\r\n            <van-icon name=\"ellipsis\" size=\"18\"/>\r\n          </template>\r\n        </van-nav-bar>\r\n        <van-search v-model=\"strFilter\" aria-placeholder=\"请输入搜索关键词\" show-action @search=\"onSearch\" @cancel=\"onCancel\"/>\r\n        <template v-for=\"(rec,idx) in data\" :key=\"idx\">\r\n          <!--van-divider>{{rec.name}}[{{rec.project_id[1]}}]</van-divider-->\r\n          <van-card :num=\"rec.stock_return_plan_line.length\" :title=\"rec.name\" :desc=\"rec.project_id[1]\">\r\n            <template #tags>\r\n              <van-tag plain v-if=\"rec.stock_id[1]\">{{rec.stock_id[1]}}</van-tag>\r\n              <van-tag plain v-if=\"rec.partner_id[1]\">{{rec.partner_id[1]}}</van-tag>\r\n              <van-tag plain v-if=\"rec.sale_id[1]\">{{rec.sale_id[1]}}</van-tag>\r\n            </template>\r\n            <template #footer>\r\n              <van-button size=\"mini\" @click=\"onAddDest(rec.id)\">现场签收</van-button>\r\n            </template>\r\n          </van-card>\r\n        </template>\r\n        \r\n        <!--van-cell v-for=\"(rec,idx) in data\" :key=\"idx\" center is-link :title=\"rec.name\" :label=\"rec.project_id[1]\" :value=\"rec.transport_waybill_count\" :url=\"'./index.html#/sendlist?sid='+rec.id\">\r\n        </van-cell-->\r\n        <van-divider v-if=\"right===false\">无权限</van-divider>\r\n        <van-action-sheet v-model:show=\"showAct\" :actions=\"actions\" @select=\"onAct\"/>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { Toast, Dialog } from 'vant'\r\nimport { getLocalStorage } from '@/utils/local-storage'\r\nimport odooApi from '@/srv'\r\nexport default {\r\n  name: 'purOrd',\r\n  data () {\r\n    return {\r\n      right: false,\r\n      showAct: false,\r\n      strFilter: '',\r\n      data: [],\r\n      actions: [\r\n        { name: '历史签收' },\r\n        { name: '退出登录' }\r\n      ]\r\n    }\r\n  },\r\n  mounted () {\r\n    this.onSearch()\r\n  },\r\n  methods: {\r\n    async onSearch () {\r\n      Toast.loading({forbidClick: true, duration: 0})\r\n      try {\r\n        this.right = await odooApi.model('stock.return.plan').checkAccessRights()\r\n        if(this.right) {\r\n          var domain = []\r\n          domain.push(['approval_state', '=', 'approval_confirm'])\r\n          if (this.strFilter) {\r\n            domain.push('|')\r\n            domain.push(['name', 'ilike', this.strFilter])\r\n            domain.push('|')\r\n            domain.push(['project_id', 'ilike', this.strFilter])\r\n            domain.push(['stock_id.name', 'ilike', this.strFilter])\r\n          }\r\n          this.data = await odooApi.model('stock.return.plan').searchRead(domain, ['name', 'partner_id', 'project_id', 'stock_id', 'sale_id', 'stock_return_plan_line'], 0, 100, 'create_date desc')\r\n          var ids = []\r\n          for(var idx in this.data) {\r\n            ids = ids.concat(this.data[idx].order_line)\r\n          }\r\n          /*\r\n          var entry = await odooApi.model('stock.return.plan.line').read(ids)\r\n          for(idx in this.data) {\r\n            this.data[idx].entry = entry.filter(rec => { return rec.order_id[0] === this.data[idx].id})\r\n          }\r\n          */\r\n        }\r\n        Toast.clear()\r\n      } catch (ex) {\r\n        Toast.clear()\r\n        Toast.fail(ex.message || ex)\r\n      }\r\n    },\r\n    onClickRight () {\r\n      this.showAct = true\r\n      /*\r\n      Dialog.confirm({\r\n        title: '退出',\r\n        message: '确定退出登录？'\r\n      }).then(()=>{\r\n        this.$router.push({name: 'Login'})\r\n      }).catch(()=>{\r\n\r\n      })\r\n      */\r\n    },\r\n    onAct (item) {\r\n      switch(item.name) {\r\n        case '历史签收':\r\n          // this.onDelete()\r\n          this.$router.push('./sendlist')\r\n          break\r\n        case '退出登录':\r\n          Dialog.confirm({\r\n            title: '退出',\r\n            message: '确定退出登录？'\r\n          }).then(()=>{\r\n            this.$router.push({name: 'Login'})\r\n          }).catch(()=>{\r\n\r\n          })\r\n          break\r\n      }\r\n    },\r\n    onAddDest (rec) {\r\n      var loginRst = getLocalStorage('user')\r\n      if (loginRst.isCust) {\r\n        this.$router.push('./recrec?sid=' + rec)\r\n      } else {\r\n        this.$router.push('./sendrec?sid=' + rec)\r\n      }\r\n      console.log(rec)\r\n    },\r\n    onCancel () {\r\n      this.strFilter = ''\r\n    }\r\n  }\r\n}\r\n</script>","import { render } from \"./PurOrd.vue?vue&type=template&id=a418ee4c\"\nimport script from \"./PurOrd.vue?vue&type=script&lang=js\"\nexport * from \"./PurOrd.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\code\\\\jw\\\\tico-yt-mobile\\\\node_modules\\\\_vue-loader@17.0.1@vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementBlock","_createVNode","_component_van_nav_bar","title","onClickRight","$options","right","_component_van_icon","name","size","_component_van_search","$data","onSearch","onCancel","_Fragment","rec","idx","_createBlock","_component_van_card","num","stock_return_plan_line","length","desc","project_id","tags","stock_id","_component_van_tag","plain","partner_id","sale_id","footer","_component_van_button","onClick","id","_component_van_divider","key","_component_van_action_sheet","show","actions","onSelect","data","showAct","strFilter","mounted","this","methods","async","Toast","forbidClick","duration","odooApi","checkAccessRights","domain","push","searchRead","ids","concat","order_line","ex","message","onAct","item","$router","Dialog","then","catch","onAddDest","loginRst","getLocalStorage","isCust","console","log","__exports__","render"],"sourceRoot":""}