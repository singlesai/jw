"use strict";(self["webpackChunktico_yt_mobile"]=self["webpackChunktico_yt_mobile"]||[]).push([[523],{5523:function(e,r,a){a.r(r),a.d(r,{default:function(){return m}});var u=a(537);const s={style:{margin:"16px"}};function t(e,r,a,t,n,i){const o=(0,u.up)("van-nav-bar"),l=(0,u.up)("van-field"),p=(0,u.up)("van-cell-group"),d=(0,u.up)("van-button"),m=(0,u.up)("van-form");return(0,u.wg)(),(0,u.iD)("div",null,[(0,u.Wm)(o,{title:"登录"}),(0,u.Wm)(m,{onSubmit:i.onSubmit},{default:(0,u.w5)((()=>[(0,u.Wm)(p,{inset:""},{default:(0,u.w5)((()=>[(0,u.Wm)(l,{modelValue:n.username,"onUpdate:modelValue":r[0]||(r[0]=e=>n.username=e),name:"用户名",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"}]},null,8,["modelValue"]),(0,u.Wm)(l,{modelValue:n.password,"onUpdate:modelValue":r[1]||(r[1]=e=>n.password=e),type:"password",name:"密码",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"])])),_:1}),(0,u._)("div",s,[(0,u.Wm)(d,{round:"",block:"",type:"primary","native-type":"submit"},{default:(0,u.w5)((()=>[(0,u.Uk)(" 提交 ")])),_:1})])])),_:1},8,["onSubmit"])])}a(6513);var n=a(2420),i=a(4144),o=a(8875),l={name:"pLogin",data(){return{username:"",password:""}},methods:{async onSubmit(){try{var e=n.Z.session,r=await e.authenticate(this.username,this.password);r.isSup=!1,r.isCust=!1;var a=[];a.push(r.partner_id);while(a.length>0){var u=await n.Z.model("res.partner").read(a,["parent_id","company_id","is_company","customer_rank","supplier_rank"]);for(var s in console.log("partner",u),a=[],u){var t=u[s];t.customer_rank>0&&(r.isCust=!0),t.supplier_rank>0&&(r.isSup=!0),t.parent_id&&a.push(t.parent_id[0])}}if((0,i.qQ)({user:JSON.stringify(r)}),r.isCust&&!r.isSup)return void this.$router.push({name:"PurOrd"});if(r.isSup&&!r.isCust)return void this.$router.push({name:"PurOrd"});this.$router.push({name:"PurOrd"})}catch(l){o.F.fail(l.message||l)}}}},p=a(3169);const d=(0,p.Z)(l,[["render",t]]);var m=d}}]);
//# sourceMappingURL=523.3a8501fd.js.map